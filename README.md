# Gastrointestinal-Diagnosis-System

基于 **Mamba 架构** 的胃肠道内窥镜图像智能诊断系统，实现多分支特征融合与在线可视化推理，旨在提高胃肠道病灶的识别准确率与诊断效率。

## 📌 项目背景
胃肠道疾病（如息肉、溃疡、出血等）的早期检测对于临床治疗具有重要意义。然而，传统诊断依赖医生人工判读内窥镜图像，存在效率低、主观性强等问题。本项目旨在利用深度学习技术，构建一个高效、鲁棒的胃肠道内窥镜图像自动诊断系统。

## 🚀 技术方案
- **模型架构**：基于 Mamba 架构的多分支视觉模型
  - **局部特征分支**：提取病灶区域的细粒度特征
  - **全局上下文分支**：捕获图像整体结构信息
  - **特征融合模块**：实现局部与全局特征的自适应融合
- **数据处理**
  - 数据集：Kvasir 数据集（多类别胃肠道图像）
  - 数据增强：随机裁剪、旋转、翻转、颜色扰动
  - 图像归一化与标准化处理
- **训练与优化**
  - 框架：PyTorch
  - 优化器：AdamW + Cosine Annealing LR
  - 损失函数：加权交叉熵 + Focal Loss
  - 超参数调优与交叉验证
- **可视化与系统实现**
  - 使用 Grad-CAM 对模型预测进行可解释性分析
  - 基于 Streamlit 构建可交互诊断平台，实现在线推理与结果可视化

## 📊 实验结果
在 **Kvasir 数据集** 测试集上，模型表现如下：
| 指标 | 结果 |
|------|------|
| 准确率 (Accuracy) | **87.25%** |
| 精确率 (Precision) | **87.21%** |
| 召回率 (Recall) | **87.29%** |
| F1 值 | **87.26%** |

与多种主流模型（如 EfficientNet、ResNet、Swin Transformer）相比，本项目在准确率和 F1 值上均有提升。

## 🛠 环境依赖
- Python >= 3.9
- PyTorch >= 2.0
- OpenCV
- NumPy
- Streamlit
- scikit-learn

安装依赖：
```bash
pip install -r requirements.txt
